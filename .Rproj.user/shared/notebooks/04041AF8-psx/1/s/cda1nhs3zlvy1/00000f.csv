"0","#| evaluate: false"
"0","# Fit logistic regression model"
"0","# glm_fit <- glm(direction ~ lag1 + lag2 + lag3 + lag4 + lag5 + vol, "
"0","#                data = psx_clean, family = binomial)"
"0","# "
"0","# # Model summary"
"0","# summary(glm_fit)"
"0","# "
"0","# # Add predicted probabilities to the dataset"
"0","# psx_clean <- psx_clean %>%"
"0","#   mutate("
"0","#     glm_probs = predict(glm_fit, type = ""response""),"
"0","#     glm_pred = if_else(glm_probs > 0.5, 1, 0)"
"0","#   )"
"0","# "
"0","# # Evaluate logistic regression performance using confusion matrix and accuracy"
"0","# confusion_matrix <- table(glm_pred = psx_clean$glm_pred, actual = psx_clean$direction)"
"0","# accuracy <- mean(psx_clean$glm_pred == psx_clean$direction)"
"0",""
"0","# Display results"
"0","#print(confusion_matrix)"
"0","#print(paste(""Overall Accuracy:"", round(accuracy, 3)))"
