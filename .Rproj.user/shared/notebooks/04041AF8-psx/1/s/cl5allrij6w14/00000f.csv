"0","#| label: data-cleaning"
"0",""
"0","# Convert the `Date` column to a proper Date format"
"0","psx <- psx %>% "
"0","  mutate(date = as.Date(Date, format = ""%m/%d/%Y"")) |> dplyr::select(-Date)"
"0","# Clean column names to make them consistent and readable"
"0","psx <- psx %>% clean_names()"
"0",""
"0","# Convert `change_percent` to numeric and create a new column `direction` for the stock movement (Up/Down)"
"0","psx <- psx %>% "
"0","  mutate("
"0","    change_percent = as.numeric(str_remove(change_percent, ""%"")),"
"0","    direction = if_else(change_percent > 0, ""Up"", ""Down"")"
"0","  )"
"0",""
"0","# Arrange data by ascending date to maintain temporal order"
"0","psx <- psx %>% arrange(date)"
"0",""
"0","# Create lag variables for `change_percent` (lags of 1 to 5 days)"
"0","psx <- psx %>% "
"0","  mutate("
"0","    lag1 = lag(change_percent, 1),"
"0","    lag2 = lag(change_percent, 2),"
"0","    lag3 = lag(change_percent, 3),"
"0","    lag4 = lag(change_percent, 4),"
"0","    lag5 = lag(change_percent, 5)"
"0","  )"
"0",""
"0","# Convert `vol` (volume) to numeric, handling the M and K suffixes"
"0","psx <- psx %>% mutate(vol = as.numeric(str_replace_all(vol, c(""M"" = ""e6"", ""K"" = ""e3""))))"
"0",""
"0","# Drop rows with missing values (NA)"
"0","psx_clean <- psx %>% drop_na()"
"0",""
"0","# Convert `direction` to numeric for binary classification (1 for ""Up"", 0 for ""Down"")"
"0","psx_clean <- psx_clean %>%"
"0","  mutate(direction = if_else(direction == ""Up"", 1, 0))"
